/*! jwplayer-sticky-desktop.0a566c4b Tue Mar 28 2023 12:16:30 GMT+0000 (Coordinated Universal Time) */
(window.vanillaJsonp=window.vanillaJsonp||[]).push([["jwplayer-sticky-desktop"],{"./src/progressive/ts/video/jwplayer/behaviours/sticky-desktop.ts":function(t,e,n){"use strict";n.r(e);var i,s,o,a,c,r,d,l,u,f,m=n("./src/progressive/ts/video/config/config-behaviour.ts"),v=n("./node_modules/fastdom/fastdom.js"),p=n.n(v),w=n("./node_modules/tsmonad/dist/tsmonad.js"),y=n("./src/progressive/ts/translator/translator.ts"),g=n("./src/progressive/ts/utils/debouncer.ts"),h=n("./src/progressive/ts/utils/monadic-dom.ts"),b=(c=window.vanilla.featureFlags.jwplayer.stickyPlayer)?(!(null===(s=null===(i=window.ffte)||void 0===i?void 0:i.properties)||void 0===s?void 0:s.articleType)||!window.vanilla.featureFlags.jwplayer.hasOwnProperty(null===(a=null===(o=window.ffte)||void 0===o?void 0:o.properties)||void 0===a?void 0:a.articleType))&&c:null,L=w.Maybe.sequence,j=!1,k=!1,E=!1,O=document.createElement("button"),x=document.createElement("div"),C=document.createElement("div"),_=document.createElement("div"),q=document.createElement("div"),M="progressive"===window.ffte.platform,S=function(t,e){j=!1,p.a.mutate((function(){C.classList.add("temp-hide"),requestAnimationFrame((function(){var n;n=C,p.a.mutate((function(){M?n.style.right="":n.style.transform=""})),C.classList.remove("stick-on"),O.classList.remove("stick-on"),_.classList.remove("stick-on"),x.classList.remove("stick-on"),t.classList.remove("sticky-player"),e.resize("100%",d),requestAnimationFrame((function(){C.classList.remove("temp-hide")}))}))})),M&&p.a.mutate((function(){t.style.right=""}))},I=function(t,e,n,i){var s={rootMargin:"100px 0px -".concat(d+99,"px 0px"),threshold:[0]},o=new IntersectionObserver((function(t){t[0].isIntersecting}),s);o.observe(n),f=o},F=function(t,e){p.a.mutate((function(){j&&(M?t.style.right="".concat(25+e,"px"):t.style.transform="translateX(".concat(626+e,"px)"))}))},z=function(t){p.a.mutate((function(){x.classList.add("sticky-player-top-fade"),C.classList.add("sticky-player-background"),q.classList.add("sticky-player-inner-vid"),_.classList.add("sticky-site-logo")}));var e,n=document.querySelector(".site-logo svg, .logo__svg svg");if(n){var i=n.cloneNode(!0);e=i,b.whitenStickyLogo&&p.a.mutate((function(){e.classList.add("whiten-logo")})),p.a.mutate((function(){_.appendChild(i)}))}var s=t.parentNode;p.a.mutate((function(){s&&(s.insertBefore(x,t),s.insertBefore(C,t)),C.appendChild(_),q.appendChild(t),C.appendChild(q)})),p.a.mutate((function(){O.innerHTML="".concat(Object(y.b)("CLOSE"),' <span style="fill:white;">').concat('<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" overflow="visible"><path d="M14 11.2L9.8 7l4.199-4.2-2.8-2.8L7 4.2 2.8 0 .002 2.8l4.2 4.2L0 11.2 2.8 14 7 9.8l4.2 4.2z"/></svg>',"</span>"),C.insertBefore(O,C.firstElementChild),O.classList.add("sticky-close")}))},T=function(t,e){var n=new IntersectionObserver((function(n){n.forEach((function(n){n.isIntersecting&&(E=!0),n.isIntersecting||!k&&E&&(!function(t,e){j=!0,p.a.mutate((function(){C.classList.add("temp-hide"),requestAnimationFrame((function(){e.classList.add("sticky-player"),t.resize(300,169),F(x,0),F(C,-12),C.classList.add("stick-on"),O.classList.add("stick-on"),_.classList.add("stick-on"),x.classList.add("stick-on"),requestAnimationFrame((function(){C.classList.remove("temp-hide")}))}))}))}(t,e),document.dispatchEvent(new CustomEvent("stickyin",{detail:{id:e.id}})))}))}),{rootMargin:"100px 0px 100px 0px",threshold:[0]});n.observe(e),u=n},A=function(t,e,n,i,s,o){u.disconnect(),f.disconnect(),T(t,i),I(0,0,s),function(t,e,n){window.innerWidth<1e3&&(u.disconnect(),f.disconnect(),j&&S(t,e))}(i,t)},B=L({sidebar:Object(h.a)("#sidebar, .listing__list",document),ffte:w.Maybe.just(window.ffte),siteName:w.Maybe.just(window.ffte.site)}).fmap((function(t){return Object.assign({},t,{sidebar:t.sidebar,ffte:t.ffte})}));document.addEventListener("jwplayerInstanceLoaded",(function(t){w.Maybe.just(t.detail.id).caseOf({just:function(t){p.a.measure((function(){B.caseOf({just:function(e){e.sidebar;var n=e.ffte.properties;if(void 0!==n){var i=!1;if(n&&(i=-1!==n.articleControlTag.indexOf("van-block-sticky-video")),!i){var s=document.querySelector(".future__jwplayer");null===s&&null===(s=document.querySelector(".future__jwplayer--carousel"))||Object(h.a)("#".concat(t),s).caseOf({just:function(e){if(!(window.innerWidth<1e3)){p.a.mutate((function(){e.style.willChange="transform"}));var n=window.jwplayer(t);if(void 0!==n){e.parentElement,e.nextElementSibling;if(null!==e.querySelector(".jw-aspect")&&Object(m.b)(m.a.STICKY)){z(e),function(t){d=t.offsetHeight,l=t.offsetWidth,r=d/l}(e),T(n,e),I(0,0,s),function(t,e,n){O.addEventListener("click",(function(){k=!0,S(t,e),p.a.mutate((function(){O.style.display="none",document.dispatchEvent(new CustomEvent("stickyclose",{detail:{id:t.id}}))}))}))}(e,n);var i,o=Object(g.a)((function(){A(n,0,0,e,s)}),250),a=Object(g.a)((function(){!function(t){var e=t.getWidth()*r;p.a.mutate((function(){t.resize("100%",e),d=e}))}(n)}),200),c=Object(g.a)((function(){F(C,-12),F(x,0)}),250);window.addEventListener("resize",(function(){o(),j?c():a()})),i=s,window.suggestionBoxPresent&&p.a.mutate((function(){i.classList.add("fiji-adjustment")}))}}}},nothing:function(){}})}}},nothing:function(){}})}))},nothing:function(){}})}))}}]);
//# sourceMappingURL=jwplayer-sticky-desktop.61d9621a2b11c203fd20.chunk.js.map